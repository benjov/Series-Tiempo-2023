#install.packages("dynlm")
#install.packages("moments")
#install.packages("broom")
#install.packages("FinTS")
#install.packages('rugarch')
#install.packages("tsbox")
#install.packages("metRology")
#install.packages("expm")
#install.packages("MTS")
#install.packages("rmgarch")
#install.packages("Rcpp")
library(expm)
library(Matrix)
library(ggplot2)
library(quantmod)
library(moments)
library(dynlm)
library(broom)
library(FinTS)
library(lubridate)
library(forecast)
library(readxl)
library(MASS)
library(rugarch)
library(tsbox)
library(MTS)
library(rmgarch)
library(Rcpp)
options("getSymbols.warning4.0"=FALSE)
BTC <-getSymbols("BTC-USD", src = "yahoo", auto.assign = FALSE)
View(BTC)
BTC <- na.omit(BTC)
chartSeries(BTC,TA='addBBands();
addBBands(draw="p");
addVo();
addMACD()',
subset='2021',
theme="white")
head(BTC)
options("getSymbols.warning4.0"=FALSE)
BTC <-getSymbols("BTC-USD", src = "yahoo", auto.assign = FALSE)
BTC <- na.omit(BTC)
chartSeries(BTC,TA='addBBands();
addBBands(draw="p");
addVo();
addMACD()',
subset='2021',
theme="white")
head(BTC)
plot(BTC$`BTC-USD.Adjusted`)
logret <- ts(diff(log(BTC$`BTC-USD.Adjusted`))[-1])
plot(logret)
alpha <- 0.05
VaR <- quantile(logret, alpha)
VaR
round(VaR, 4)
round(VaR, 4)*100
qplot(logret , geom = 'histogram') + geom_histogram(fill = 'lightblue' , bins = 30) +
geom_histogram(aes(logret[logret < quantile(logret , 0.05)]) , fill = 'red' , bins = 30) +
labs(x = 'Daily Returns')
qplot(logret , geom = 'histogram') + geom_histogram(fill = 'lightblue' , bins = 10) +
geom_histogram(aes(logret[logret < quantile(logret , 0.05)]) , fill = 'red' , bins = 10) +
labs(x = 'Daily Returns')
qplot(logret , geom = 'histogram') + geom_histogram(fill = 'lightblue' , bins = 100) +
geom_histogram(aes(logret[logret < quantile(logret , 0.05)]) , fill = 'red' , bins = 100) +
labs(x = 'Daily Returns')
qplot(logret , geom = 'histogram') + geom_histogram(fill = 'lightblue' , bins = 30) +
geom_histogram(aes(logret[logret < quantile(logret , 0.05)]) , fill = 'red' , bins = 30) +
labs(x = 'Daily Returns')
?rnorm
normal_dist <- rnorm(100000, mean(logret), sd(logret))
VaR_n <- quantile(normal_dist, 0.05)
ES_n <- mean(normal_dist[normal_dist<VaR])
ggplot()+
geom_density(aes(logret, geom ='density', col = 'returns'))+
geom_density(aes(normal_dist, col = 'normal'))
vector_ret <- as.vector(logret)
##Kurtosis
round(kurtosis(vector_ret),2)
##Sesgo
round(skewness(vector_ret),2)
##Prueba de normalidad
jarque.test(vector_ret)
